# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø–∏—Å–∏ –≤–∏–¥–µ–æ

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** –î–µ–∫–∞–±—Ä—å 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π

---

## üìã –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –≤–∏–¥–µ–æ —Å IP-–∫–∞–º–µ—Ä —á–µ—Ä–µ–∑ RTSP –ø—Ä–æ—Ç–æ–∫–æ–ª. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–µ—Ä–≤–∏—Å –∑–∞–ø–∏—Å–∏, Use Cases, API endpoints –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. VideoRecordingService

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `server/api/src/main/kotlin/com/company/ipcamera/server/service/VideoRecordingService.kt`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∑–∞–ø–∏—Å–µ–π (—Å—Ç–∞—Ä—Ç, —Å—Ç–æ–ø, –ø–∞—É–∑–∞, –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å RTSP –∫–ª–∏–µ–Ω—Ç–æ–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–æ–≤
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ —Ñ–∞–π–ª—ã (MP4, MKV, AVI, MOV, FLV)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è thumbnail'–æ–≤ —á–µ—Ä–µ–∑ FFmpeg (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π (—Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
```kotlin
suspend fun startRecording(
    camera: Camera,
    format: RecordingFormat = RecordingFormat.MP4,
    quality: Quality = Quality.HIGH,
    duration: Long? = null
): Result<Recording>

suspend fun stopRecording(cameraId: String): Result<Recording>
suspend fun pauseRecording(cameraId: String): Result<Recording>
suspend fun resumeRecording(cameraId: String): Result<Recording>
suspend fun cleanupOldRecordings(maxAgeDays: Int = 30, maxStorageBytes: Long? = null)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ConcurrentHashMap` –¥–ª—è thread-safe —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏
- –°–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π `CoroutineScope` –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∑–∞–ø–∏—Å–µ–π –∏ thumbnail'–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø–∏—Å–∏

### 2. Use Cases

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/`

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ Use Cases:

#### StartRecordingUseCase
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞–º–µ—Ä—ã (—Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, —Å—Ç–∞—Ç—É—Å)
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

#### StopRecordingUseCase
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–ø–∏—Å–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ COMPLETED

#### PauseRecordingUseCase
- –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –∑–∞–ø–∏—Å–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PAUSED

#### ResumeRecordingUseCase
- –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ ACTIVE

#### GetRecordingsUseCase
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

#### DeleteRecordingUseCase
- –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- TODO: –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∑–∞–ø–∏—Å–∏ –∏ thumbnail'–æ–≤

### 3. API Endpoints

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `server/api/src/main/kotlin/com/company/ipcamera/server/routing/RecordingRoutes.kt`

**–ù–æ–≤—ã–µ endpoints:**
- `POST /api/v1/recordings/start` - –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å
  - –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: `StartRecordingRequest` (cameraId, format, quality, duration)
  - –û—Ç–≤–µ—Ç: `StartRecordingResponse` (recordingId, cameraId, startTime, estimatedEndTime)

- `POST /api/v1/recordings/stop/{cameraId}` - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
  - –û—Ç–≤–µ—Ç: `RecordingDto` —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å—å—é

- `POST /api/v1/recordings/pause/{cameraId}` - –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
  - –û—Ç–≤–µ—Ç: `RecordingDto` —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å—å—é

- `POST /api/v1/recordings/resume/{cameraId}` - –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
  - –û—Ç–≤–µ—Ç: `RecordingDto` —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∑–∞–ø–∏—Å—å—é

**–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints (—É–∂–µ –±—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã):**
- `GET /api/v1/recordings` - –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π
- `GET /api/v1/recordings/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
- `DELETE /api/v1/recordings/{id}` - –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
- `GET /api/v1/recordings/{id}/download` - URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- `POST /api/v1/recordings/{id}/export` - –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–∏

### 4. DTO

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `server/api/src/main/kotlin/com/company/ipcamera/server/dto/RecordingDto.kt`

**–ù–æ–≤—ã–µ DTO:**
```kotlin
@Serializable
data class StartRecordingRequest(
    val cameraId: String,
    val format: String? = "MP4",
    val quality: String? = "HIGH",
    val duration: Long? = null
)

@Serializable
data class StartRecordingResponse(
    val recordingId: String,
    val cameraId: String,
    val startTime: Long,
    val estimatedEndTime: Long? = null
)
```

### 5. Dependency Injection

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `server/api/src/main/kotlin/com/company/ipcamera/server/di/AppModule.kt`

–î–æ–±–∞–≤–ª–µ–Ω `VideoRecordingService` –≤ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
```kotlin
single<VideoRecordingService> { 
    VideoRecordingService(
        recordingRepository = get(),
        recordingsDirectory = "recordings",
        thumbnailsDirectory = "thumbnails"
    )
}
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å RTSP –∫–ª–∏–µ–Ω—Ç–æ–º

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `RtspClient` –∏–∑ –º–æ–¥—É–ª—è `core:network`:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ RTSP –ø–æ—Ç–æ–∫—É –∫–∞–º–µ—Ä—ã
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∏–¥–µ–æ–∫–∞–¥—Ä–æ–≤ —á–µ—Ä–µ–∑ `getVideoFrames()`
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∞—É–¥–∏–æ–∫–∞–¥—Ä–æ–≤ —á–µ—Ä–µ–∑ `getAudioFrames()` (–µ—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–µ LOW)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç—ã –∑–∞–ø–∏—Å–∏

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã:
- **MP4** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –Ω–∞–∏–±–æ–ª–µ–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç
- **MKV** - –æ—Ç–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Ö–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–µ–∫–æ–≤
- **AVI** - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π, –Ω–æ —à–∏—Ä–æ–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π
- **MOV** - —Ñ–æ—Ä–º–∞—Ç Apple QuickTime
- **FLV** - Flash Video (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π)

### –ö–∞—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–∏

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —É—Ä–æ–≤–Ω–∏ –∫–∞—á–µ—Å—Ç–≤–∞:
- **LOW** - –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, —Ç–æ–ª—å–∫–æ –≤–∏–¥–µ–æ
- **MEDIUM** - —Å—Ä–µ–¥–Ω–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –≤–∏–¥–µ–æ + –∞—É–¥–∏–æ
- **HIGH** - –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –≤–∏–¥–µ–æ + –∞—É–¥–∏–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **ULTRA** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –≤–∏–¥–µ–æ + –∞—É–¥–∏–æ

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è thumbnail'–æ–≤

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ FFmpeg (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω):
```bash
ffmpeg -i video.mp4 -ss 00:00:01 -vframes 1 -vf scale=320:-1 thumbnail.jpg
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ë–µ—Ä–µ—Ç –∫–∞–¥—Ä –Ω–∞ 1 —Å–µ–∫—É–Ω–¥–µ –∑–∞–ø–∏—Å–∏
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –¥–æ —à–∏—Ä–∏–Ω—ã 320px
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `thumbnails/`
- –ï—Å–ª–∏ FFmpeg –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, thumbnail –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞:
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å
- –£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ)
- –£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã –∑–∞–ø–∏—Å–µ–π –∏ thumbnail'—ã
- –õ–æ–≥–∏—Ä—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
```kotlin
suspend fun cleanupOldRecordings(
    maxAgeDays: Int = 30,
    maxStorageBytes: Long? = null
)
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 1. –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ó–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å—ã—Ä—ã–µ –∫–∞–¥—Ä—ã –∏–∑ RTSP –ø–æ—Ç–æ–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FFmpeg –∏–ª–∏ –Ω–∞—Ç–∏–≤–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ MP4/MKV

**TODO:**
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å FFmpeg –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∏–∑ `native/video-processing`
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è thumbnail'–æ–≤

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ FFmpeg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö FFmpeg –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:** 
- –î–æ–±–∞–≤–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–∞—Ç–∏–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –≤ Kotlin

### 3. –•—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è in-memory —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è MVP

**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–ø–∏—Å–∏ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

**–†–µ—à–µ–Ω–∏–µ:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ SQLDelight/PostgreSQL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

**TODO:**
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å—Ö–µ–º—ã –∑–∞–ø–∏—Å–µ–π

### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º, –Ω–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤–Ω–µ—à–Ω–∏—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â (S3, NFS)
- –î–æ–±–∞–≤–∏—Ç—å –∫–≤–æ—Ç—ã –Ω–∞ –∑–∞–ø–∏—Å—å

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã/–∏–∑–º–µ–Ω–µ–Ω—ã

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `server/api/src/main/kotlin/com/company/ipcamera/server/service/VideoRecordingService.kt` (532 —Å—Ç—Ä–æ–∫–∏)
- `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/StartRecordingUseCase.kt`
- `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/StopRecordingUseCase.kt`
- `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/PauseRecordingUseCase.kt`
- `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/ResumeRecordingUseCase.kt`
- `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/GetRecordingsUseCase.kt`
- `shared/src/commonMain/kotlin/com/company/ipcamera/shared/domain/usecase/DeleteRecordingUseCase.kt`

**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `server/api/src/main/kotlin/com/company/ipcamera/server/routing/RecordingRoutes.kt` (+200 —Å—Ç—Ä–æ–∫)
- `server/api/src/main/kotlin/com/company/ipcamera/server/dto/RecordingDto.kt` (+30 —Å—Ç—Ä–æ–∫)
- `server/api/src/main/kotlin/com/company/ipcamera/server/di/AppModule.kt` (+5 —Å—Ç—Ä–æ–∫)

**–í—Å–µ–≥–æ:** ~800 —Å—Ç—Ä–æ–∫ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏: 100%
- ‚úÖ API endpoints: 100%
- ‚úÖ Use Cases: 100%
- ‚ö†Ô∏è –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ: 30% (–±–∞–∑–æ–≤–∞—è –∑–∞–ø–∏—Å—å, —Ç—Ä–µ–±—É–µ—Ç—Å—è FFmpeg)
- ‚ö†Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è thumbnail'–æ–≤: 70% (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å FFmpeg)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞: 100%

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** ~85%

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è FFmpeg –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ**
   - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å FFmpeg –≤ –ø—Ä–æ–µ–∫—Ç
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ MP4/MKV
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∫–æ–¥–µ–∫–∞–º–∏

2. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ SQLDelight/PostgreSQL**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å—Ö–µ–º—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω—ã–π)

3. **–£–ª—É—á—à–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ thumbnail'–æ–≤**
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ FFmpeg
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ thumbnail'–æ–≤

4. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –º–µ—Å—Ç–∞
   - –ö–≤–æ—Ç—ã –Ω–∞ –∑–∞–ø–∏—Å—å
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)

5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–∏
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–º–µ—Ä
   - –°–∂–∞—Ç–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

6. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**
   - –ó–∞–ø–∏—Å—å –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
   - –ó–∞–ø–∏—Å—å –ø–æ —Å–æ–±—ã—Ç–∏—è–º (motion detection)
   - –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–ø–∏—Å–µ–π –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [RTSP_CLIENT_IMPLEMENTATION_STATUS.md](RTSP_CLIENT_IMPLEMENTATION_STATUS.md) - –°—Ç–∞—Ç—É—Å RTSP –∫–ª–∏–µ–Ω—Ç–∞
- [API.md](API.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- [IMPLEMENTATION_STATUS.md](IMPLEMENTATION_STATUS.md) - –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [MISSING_FUNCTIONALITY.md](MISSING_FUNCTIONALITY.md) - –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –î–µ–∫–∞–±—Ä—å 2025

