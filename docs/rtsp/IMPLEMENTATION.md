# –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ RTSP –∫–ª–∏–µ–Ω—Ç–∞

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 3.0
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 27 —è–Ω–≤–∞—Ä—è 2025
**–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è:** 2.0 (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞: 27 —è–Ω–≤–∞—Ä—è 2025)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è

> **üìö –ê—Ä—Ö–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –°—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `docs/archive/`

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ù–∞—á–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** ~10% (—Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- **–¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** ~50% (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞)
- **–£–ª—É—á—à–µ–Ω–∏–µ:** +40%

### –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—Ä–æ–≥—Ä–µ—Å—Å | –°—Ç–∞—Ç—É—Å |
|-----------|----------|--------|
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è cinterop | 100% | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è build.gradle.kts | 100% | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CMakeLists.txt | 100% | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ |
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ | 100% | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 100% | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ |
| –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ | 100% | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ |
| –ö–æ–º–ø–∏–ª—è—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ | 0% | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π |
| –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–∞ | 0% | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 0% | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| Android/iOS –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã | 0% | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### 1.1 Cinterop –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `.def` —Ñ–∞–π–ª (language = C)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—É—Ç–∏ –∫ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–º —Ñ–∞–π–ª–∞–º
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã linker –æ–ø—Ü–∏–∏

#### 1.2 Gradle –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ macOS (macosX64, macosArm64)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã cinterops –¥–ª—è –≤—Å–µ—Ö native –ø–ª–∞—Ç—Ñ–æ—Ä–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã sourceSets

#### 1.3 CMake –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ SHARED
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã visibility –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è macOS –∏ Linux

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ NativeRtspClient.native.kt
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞, –≥–æ—Ç–æ–≤–∞ –∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤
- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è callbacks —Å StableRef

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `scripts/build-native-lib.sh` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏
- ‚úÖ –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ `docs/RTSP_BUILD_INSTRUCTIONS.md` - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ
- ‚úÖ `docs/RTSP_CLIENT_ACTIVATION_GUIDE.md` - –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- ‚úÖ `docs/RTSP_CLIENT_SETUP_SUMMARY.md` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞
- ‚úÖ `native/video-processing/README.md` - README –Ω–∞—Ç–∏–≤–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- ‚úÖ –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ `docs/rtsp/`

---

## ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (—Ä—É—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**macOS:**
```bash
brew install cmake ffmpeg pkg-config
```

**Ubuntu/Debian:**
```bash
sudo apt-get install cmake build-essential pkg-config \
    libavformat-dev libavcodec-dev libavutil-dev \
    libswscale-dev libswresample-dev
```

### –®–∞–≥ 2: –ö–æ–º–ø–∏–ª—è—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```bash
./scripts/build-native-lib.sh
```

### –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è cinterop –±–∏–Ω–¥–∏–Ω–≥–æ–≤

```bash
./gradlew :core:network:compileKotlinNative
```

### –®–∞–≥ 4: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–∞

–°–º. –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: [ACTIVATION.md](ACTIVATION.md)

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ/–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `core/network/src/nativeInterop/cinterop/rtsp_client.def` - –æ–±–Ω–æ–≤–ª–µ–Ω
- `core/network/build.gradle.kts` - –æ–±–Ω–æ–≤–ª–µ–Ω
- `native/video-processing/CMakeLists.txt` - –æ–±–Ω–æ–≤–ª–µ–Ω

### –ö–æ–¥
- `core/network/src/commonMain/.../RtspClient.kt` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω pause()
- `core/network/src/nativeMain/.../NativeRtspClient.native.kt` - –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –°–∫—Ä–∏–ø—Ç—ã
- `scripts/build-native-lib.sh` - —Å–æ–∑–¥–∞–Ω

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/RTSP_BUILD_INSTRUCTIONS.md` - —Å–æ–∑–¥–∞–Ω
- `docs/RTSP_CLIENT_ACTIVATION_GUIDE.md` - —Å–æ–∑–¥–∞–Ω
- `docs/RTSP_CLIENT_SETUP_SUMMARY.md` - —Å–æ–∑–¥–∞–Ω
- `native/video-processing/README.md` - —Å–æ–∑–¥–∞–Ω
- `docs/rtsp/` - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–≤–µ—Ä—Å–∏—è 2.0)

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** (FFmpeg, CMake) - —Ä—É—á–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
2. **–°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É** - `./scripts/build-native-lib.sh`
3. **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–∏–Ω–¥–∏–Ω–≥–∏** - `./gradlew :core:network:compileKotlinNative`
4. **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥** - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ NativeRtspClient.native.kt
5. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** - –±–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å RTSP –∫–∞–º–µ—Ä–æ–π
6. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Android/iOS** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–æ–º

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è HLS –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞ —Å RTSP –∫–ª–∏–µ–Ω—Ç–æ–º –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:

- **HlsGeneratorService** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è HLS —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ FFmpeg
- **VideoStreamService** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–µ–π RTSP –ø–æ—Ç–æ–∫–æ–≤
- **ScreenshotService** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –∫–∞–¥—Ä–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –∫–∞—á–µ—Å—Ç–≤–∞ (LOW, MEDIUM, HIGH, ULTRA)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç—å—é

### API Endpoints

- `POST /api/v1/cameras/{id}/stream/start` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é
- `POST /api/v1/cameras/{id}/stream/stop` - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é
- `GET /api/v1/cameras/{id}/stream/status` - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å
- `GET /api/v1/cameras/streams/{streamId}/hls/playlist.m3u8` - HLS –ø–ª–µ–π–ª–∏—Å—Ç
- `POST /api/v1/cameras/{id}/stream/screenshot` - —Å–æ–∑–¥–∞—Ç—å —Å–Ω–∏–º–æ–∫

–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∞—Ä—Ö–∏–≤–µ (—Å–º. `docs/archive/2025-01-27/RTSP_VIDEO_PLAYER_INTEGRATION.md`).

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `docs/rtsp/`:

1. **[ACTIVATION.md](ACTIVATION.md)** - –ß–µ–∫-–ª–∏—Å—Ç –∏ —à–∞–≥–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
2. **[INSTALLATION.md](INSTALLATION.md)** - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **[IMPLEMENTATION.md](IMPLEMENTATION.md)** - –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç (—Å—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–∞—á–Ω–∏—Ç–µ —Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–ª—å–∑—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç build-native-lib.sh** - –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞
3. **–°–ª–µ–¥—É–π—Ç–µ ACTIVATION.md** - —Ç–∞–º –µ—Å—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —à–∞–≥–∏
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç —Å–∏–º–≤–æ–ª–æ–≤** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–±—Ä–∞–Ω–∞

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 3.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 27 —è–Ω–≤–∞—Ä—è 2025
**–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è:** 2.0 (–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞: 27 —è–Ω–≤–∞—Ä—è 2025)
**–°–æ–∑–¥–∞–Ω–æ:** –î–µ–∫–∞–±—Ä—å 2025

