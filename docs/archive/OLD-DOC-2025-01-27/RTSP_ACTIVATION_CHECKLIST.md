# –ß–µ–∫-–ª–∏—Å—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ RTSP –∫–ª–∏–µ–Ω—Ç–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ RTSP –∫–ª–∏–µ–Ω—Ç–∞.

---

## ‚úÖ –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω CMake (‚â• 3.15)
  ```bash
  cmake --version
  ```

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω FFmpeg (libavformat, libavcodec, libavutil, libswscale)
  ```bash
  pkg-config --exists libavformat && echo "OK" || echo "NOT FOUND"
  ```

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω pkg-config
  ```bash
  pkg-config --version
  ```

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è macOS:**
```bash
brew install cmake ffmpeg pkg-config
```

---

## ‚úÖ –®–∞–≥ 2: –ö–æ–º–ø–∏–ª—è—Ü–∏—è –Ω–∞—Ç–∏–≤–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- [ ] –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–∞
  ```bash
  ./scripts/build-native-lib.sh
  ```

- [ ] –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
  - macOS: `native/video-processing/build/libvideo_processing.dylib`
  - Linux: `native/video-processing/build/libvideo_processing.so`

- [ ] –°–∏–º–≤–æ–ª—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å):
  ```bash
  # macOS
  nm -gU native/video-processing/build/libvideo_processing.dylib | grep rtsp_client
  
  # Linux
  nm -D native/video-processing/build/libvideo_processing.so | grep rtsp_client
  ```

- [ ] –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ lib/:
  - macOS: `native/video-processing/lib/macos/libvideo_processing.dylib`
  - Linux: `native/video-processing/lib/linux/libvideo_processing.so`

---

## ‚úÖ –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è cinterop –±–∏–Ω–¥–∏–Ω–≥–æ–≤

- [ ] Kotlin/Native –ø—Ä–æ–µ–∫—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω
  ```bash
  ./gradlew :core:network:compileKotlinNative
  ```

- [ ] –ë–∏–Ω–¥–∏–Ω–≥–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤):
  ```
  core/network/build/bin/native/.../klib/.../com/company/ipcamera/core/network/rtsp/rtsp_client/
  ```

---

## ‚úÖ –®–∞–≥ 4: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–∞

### 4.1 –ò–º–ø–æ—Ä—Ç—ã

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∏–º–ø–æ—Ä—Ç –≤ `NativeRtspClient.native.kt` (—Å—Ç—Ä–æ–∫–∞ ~14):
  ```kotlin
  import com.company.ipcamera.core.network.rtsp.rtsp_client.*
  ```

### 4.2 –ú–µ—Ç–æ–¥ create()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `create()`

### 4.3 –ú–µ—Ç–æ–¥ connect()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `connect()`

### 4.4 –ú–µ—Ç–æ–¥ disconnect()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `disconnect()`

### 4.5 –ú–µ—Ç–æ–¥ getStatus()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `getStatus()`

### 4.6 –ú–µ—Ç–æ–¥ play()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `play()`

### 4.7 –ú–µ—Ç–æ–¥ stop()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `stop()`

### 4.8 –ú–µ—Ç–æ–¥ pause()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `pause()`

### 4.9 –ú–µ—Ç–æ–¥ getStreamCount()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `getStreamCount()`

### 4.10 –ú–µ—Ç–æ–¥ getStreamType()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `getStreamType()`

### 4.11 –ú–µ—Ç–æ–¥ getStreamInfo()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `getStreamInfo()`

### 4.12 –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `handleToPointer()`
- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `convertNativeStatus()`
- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `convertNativeStreamType()`
- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `convertStreamType()`

### 4.13 Callbacks

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `setFrameCallback()` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º StableRef
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `setStatusCallback()` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º StableRef
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `convertNativeFrame()` (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)

### 4.14 –ú–µ—Ç–æ–¥ destroy()

- [ ] –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `destroy()`

---

## ‚úÖ –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

- [ ] –ü—Ä–æ–µ–∫—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
  ```bash
  ./gradlew :core:network:compileKotlinNative
  ```

- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ "Unresolved reference"
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ —Ç–∏–ø–æ–≤

---

## ‚úÖ –®–∞–≥ 6: –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π RTSP –∫–ª–∏–µ–Ω—Ç
- [ ] –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (connect)
- [ ] –¢–µ—Å—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (play)
- [ ] –¢–µ—Å—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (stop)
- [ ] –¢–µ—Å—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è (disconnect)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É.

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ —Å–º.:
- [RTSP_CLIENT_ACTIVATION_GUIDE.md](docs/RTSP_CLIENT_ACTIVATION_GUIDE.md) - —Ä–∞–∑–¥–µ–ª "–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã"
- [RTSP_BUILD_INSTRUCTIONS.md](docs/RTSP_BUILD_INSTRUCTIONS.md) - —Ä–∞–∑–¥–µ–ª "–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º"

---

**–°–æ–∑–¥–∞–Ω–æ:** –î–µ–∫–∞–±—Ä—å 2025

