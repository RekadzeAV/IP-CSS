# Шаблон активации кода RTSP клиента

**ВАЖНО:** Этот файл содержит шаблон активированного кода. Используйте его как reference после генерации cinterop биндингов.

---

## ⚠️ Предупреждение

Этот код содержит предполагаемые типы и вызовы. После генерации cinterop биндингов, проверьте правильность типов и адаптируйте код соответственно.

---

## Структура активированного кода

### 1. Импорты

```kotlin
import com.company.ipcamera.core.network.rtsp.rtsp_client.*
```

### 2. Основные методы (готовы к раскомментированию)

Все методы уже подготовлены в файле `NativeRtspClient.native.kt` с комментариями TODO.

После генерации биндингов:
1. Раскомментируйте импорт
2. Раскомментируйте реализацию каждого метода
3. Раскомментируйте вспомогательные функции

### 3. Callbacks (требует внимания)

Callbacks требуют правильной реализации с использованием StableRef. См. примеры в файле `.prepared`.

---

## Шаги активации

### Шаг 1: Проверьте сгенерированные типы

После компиляции cinterop, проверьте сгенерированные типы:

```
core/network/build/bin/native/.../klib/.../com/company/ipcamera/core/network/rtsp/rtsp_client/
```

Убедитесь, что следующие типы доступны:
- `RTSPClientVar`
- `RTSPStatus`
- `RTSPStreamType`
- `rtsp_client_create()`
- `rtsp_client_connect()`
- и другие функции

### Шаг 2: Адаптируйте код

Возможно, потребуется адаптация:
- Имен типов (например, `RTSPClientVar` может быть `RTSPClient`)
- Способы доступа к указателям (`.rawValue`, `.getRawValue()`, и т.д.)
- Сигнатуры функций (особенно callbacks)

### Шаг 3: Проверка компиляции

```bash
./gradlew :core:network:compileKotlinNative
```

Исправьте все ошибки компиляции.

---

## Известные проблемы

### Callbacks

Реализация callbacks может потребовать дополнительной работы, так как:
- cinterop генерирует специфичные типы для callback функций
- Может потребоваться использование `CFunction` или других типов
- StableRef должен быть правильно использован

**Решение:** Проверьте сгенерированные типы и адаптируйте код.

### Указатели

Способы работы с указателями могут отличаться:
- `interpretCPointer` vs `reinterpret`
- Доступ к `.rawValue` может отличаться

**Решение:** Используйте сгенерированные типы как reference.

---

## См. также

- `RTSP_ACTIVATION_CHECKLIST.md` - Чек-лист активации
- `docs/RTSP_CLIENT_ACTIVATION_GUIDE.md` - Полное руководство
- Подготовленный файл: `core/network/src/nativeMain/.../NativeRtspClient.native.kt.prepared` (reference)

